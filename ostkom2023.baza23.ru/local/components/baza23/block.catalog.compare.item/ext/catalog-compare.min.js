!function(t){"use strict";t.jsc_CatalogCompareItem||(t.jsc_CatalogCompareItem=function(t){this.ajax={URL:"/local/components/baza23/block.catalog.compare.item/ext/ajax.php",MODULE:"module=compare",ACTION_VARIABLE:"action",ID_VARIABLE:"id",OUTPUT:"console"},this.cssClass="product-item-compare",this.visual={ID:""},this.obProduct=null,this.errorCode=0,"object"==typeof t&&(t.URL&&(this.ajax.URL=t.URL),this.visual.ID=t.CSS_ID,""===this.visual.ID&&(this.errorCode=-2)),0===this.errorCode?BX.ready(BX.delegate(this.init,this)):console.log("jsc_CatalogCompareItem errorCode =",this.errorCode)},t.jsc_CatalogCompareItem.prototype={init:function(){if(this.obProduct=$("#"+this.visual.ID),!this.obProduct.length)return this.errorCode=-4,console.log("jsc_CatalogCompareItem errorCode =",this.errorCode,"(#"+this.visual.ID+")"),this.errorCode;let o=this,t="."+this.cssClass+' input[type="checkbox"]';this.obProduct.on("change",t,function(){var t=$(this).data("productId");return t&&($(this).is(":checked")?o.jsf_addProductId(t)||$(this).removeAttr("checked"):o.jsf_removeProductId(t)),!1})},jsf_getProductIds:function(){let e=this,a=this.ajax.MODULE+"&SITE_ID="+jso_local.SITE_ID+"&"+this.ajax.ACTION_VARIABLE+"=GET_COMPARE_LIST",o=[];return $.ajax({url:this.ajax.URL,type:"GET",data:a,dataType:"json",async:!1,error:function(t,o,s){"console"==e.ajax.OUTPUT?console.log("jsc_CatalogCompareItem.jsf_getProductIds",a,o,s):jso_utilities.jsf_ajaxError(t,o,s)},success:function(t){t.success?null!=t.productIds&&null!=t.productIds&&(o=t.productIds):"console"==e.ajax.OUTPUT?console.log("jsc_CatalogCompareItem.jsf_getProductIds",t):alert(t.text)}}),o},jsf_addProductId:function(o){let e=this,a=this.ajax.MODULE+"&SITE_ID="+jso_local.SITE_ID+"&"+this.ajax.ID_VARIABLE+"="+o+"&"+this.ajax.ACTION_VARIABLE+"=ADD_TO_COMPARE_LIST",s=!1;return $.ajax({url:this.ajax.URL,type:"GET",data:a,dataType:"json",async:!1,error:function(t,o,s){"console"==e.ajax.OUTPUT?console.log("jsc_CatalogCompareItem.jsf_addProductId",a,o,s):jso_utilities.jsf_ajaxError(t,o,s)},success:function(t){t.success?(s=!0,$("."+e.cssClass+' input[data-product-id="'+o+'"]').attr("checked","checked"),e.jsf_changeCompareCount()):"console"==e.ajax.OUTPUT?console.log("jsc_CatalogCompareItem.jsf_addProductId",a,t):alert(t.text)}}),s},jsf_removeProductId:function(o){let e=this,a=this.ajax.MODULE+"&SITE_ID="+jso_local.SITE_ID+"&"+this.ajax.ID_VARIABLE+"="+o+"&"+this.ajax.ACTION_VARIABLE+"=DELETE_FROM_COMPARE_LIST",s=!1;return $.ajax({url:this.ajax.URL,type:"GET",data:a,dataType:"json",async:!1,error:function(t,o,s){"console"==e.ajax.OUTPUT?console.log("jsc_CatalogCompareItem.jsf_removeProductId",a,o,s):jso_utilities.jsf_ajaxError(t,o,s)},success:function(t){t.success?(s=!0,$("."+e.cssClass+' input[data-product-id="'+o+'"]').removeAttr("checked"),e.jsf_changeCompareCount()):"console"==e.ajax.OUTPUT?console.log("jsc_CatalogCompareItem.jsf_removeProductId",a,t):alert(t.text)}}),s},jsf_changeCompareCount:function(){let t=this.jsf_getProductIds(),o=0,s=$(".catalog-compare-link");"object"==typeof t?o=Object.keys(t).length:"array"==typeof t&&(o=t.length),s.find(".item-count").html(o),t.length<=0?s.addClass("empty-list"):s.removeClass("empty-list")},jsf_checkCompare:function(t){let e=this.jsf_getProductIds(),o="."+this.cssClass+' input[type="checkbox"]';$(t).hasClass(this.cssClass)&&(o='input[type="checkbox"]'),e&&$(t).find(o).each(function(t,o){var s=$(this).data("productId");0<=$.inArray(s,e)?$(this).attr("checked","checked"):$(this).removeAttr("checked")})}})}(window);